{"version":3,"file":"extension.js","sources":["../../../../../src/EventHandlers.tsx","../../../../../src/SendByMailButton/SendByMailButton.tsx","../../../../../src/Index.ts"],"sourcesContent":["﻿import { $RequestManager } from \"@docsvision/webclient/System/$RequestManager\";\nimport { LayoutControl } from \"@docsvision/webclient/System/BaseControl\";\nimport { IEventArgs } from \"@docsvision/webclient/System/IEventArgs\";;\nimport { $CardId } from \"@docsvision/webclient/System/LayoutServices\";\n\n// Все функции, классы и переменные используемые за пределами модуля (т.е. файла)\n// должны экспортироваться (содержать ключевое слово export в объявлении).\n// export function someHandler(sender: LayoutControl, e: IEventArgs) {\n//     let cardIdService = sender.layout.getService($CardId);\n//     let requestManager = sender.layout.getService($RequestManager);\n//     requestManager.get\n    \n// }","import { $RequestManager } from \"@docsvision/webclient/System/$RequestManager\";\r\nimport { $UrlResolver} from '@docsvision/webclient/System/$UrlResolver';\r\nimport { BaseControlParams, BaseControlState, BaseControl } from \"@docsvision/webclient/System/BaseControl\";\r\nimport { ControlImpl } from \"@docsvision/webclient/System/ControlImpl\";\r\nimport { $CardInfo } from \"@docsvision/webclient/System/LayoutServices\";\r\nimport { TextBox } from \"@docsvision/webclient/Platform/TextBox\";\r\nimport { rw } from \"@docsvision/webclient/System/Readwrite\";\r\nimport React from \"react\";\r\n\r\nexport class SendByMailButtonParams extends BaseControlParams {\r\n    standardCssClass?: string = \"sendbymail-button\";\r\n    @rw services?: $RequestManager & $UrlResolver & $CardInfo;\r\n}\r\n\r\nexport interface SendByMailButtonState extends BaseControlState, SendByMailButtonParams {\r\n    description: any;\r\n\r\n}\r\ndeclare var WebClient: any;\r\nexport class SendByMailButton extends BaseControl<SendByMailButtonParams, SendByMailButtonState> {\r\n\r\n    protected createParams(): SendByMailButtonParams {\r\n        return new SendByMailButtonParams();\r\n    }\r\n\r\n    protected createImpl() {\r\n        return new ControlImpl(this.props, this.state, this.renderControl.bind(this));\r\n    }\r\n\r\n    renderControl() {\r\n        \r\n        this.state.description = this.layout.controls.get<TextBox>(\"documentName\").value; \r\n        let url = this.state.services.urlResolver.resolveApiUrl('GetEmail','Email') + '?cardId=' + this.layout.cardInfo.id;\r\n        let answer = this.state.services.requestManager.get<string>(url).then(\r\n            (e) => {\r\n                let attr = document.createAttribute('href');\r\n                attr.value = \"mailto:{0}&body={1}\".format(e,  this.state.description);\r\n                document.getElementById('sendemailbuttonlink').attributes.setNamedItem(attr);\r\n                return \"\";\r\n            });\r\n    \r\n        return (\r\n            <div>\r\n                <a id='sendemailbuttonlink' href=\"\">SendByMail</a>\r\n            </div>\r\n        );\r\n    }\r\n}","﻿import * as EventHandlers from \"./EventHandlers\";\r\nimport { extensionManager } from \"@docsvision/webclient/System/ExtensionManager\";\r\nimport { SendByMailButton } from \"./SendByMailButton/SendByMailButton\";\r\n\r\n\r\n// Главная входная точка всего расширения\r\n// Данный файл должен импортировать прямо или косвенно все остальные файлы, \r\n// чтобы rollup смог собрать их все в один бандл.\r\n\r\n// Регистрация расширения позволяет корректно установить все\r\n// обработчики событий, сервисы и прочие сущности web-приложения.\r\nextensionManager.registerExtension({\r\n    name: \"SendByMailButton web extension\",\r\n    version: \"5.5.16\",\r\n    controls: [\r\n        { controlTypeName: \"SendByMailButton\", constructor: SendByMailButton },\r\n    ],\r\n    globalEventHandlers: [ EventHandlers ]\r\n})"],"names":["__extends","__decorate","rw","BaseControlParams","ControlImpl","React","BaseControl","extensionManager"],"mappings":";;;;;;IAKA;IACA;IACA;IACA;IACA;IACA;IAEA;;;;;;ICHA;QAA4CA,gDAAiB;QAA7D;YAAA,qEAGC;YAFG,sBAAgB,GAAY,mBAAmB,CAAC;;SAEnD;QADOC;YAAHC,YAAE;gEAAuD;QAC9D,6BAAC;KAAA,CAH2CC,6BAAiB,GAG5D;IAOD;QAAsCH,0CAA0D;QAAhG;;SA4BC;QA1Ba,uCAAY,GAAtB;YACI,OAAO,IAAI,sBAAsB,EAAE,CAAC;SACvC;QAES,qCAAU,GAApB;YACI,OAAO,IAAII,uBAAW,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACjF;QAED,wCAAa,GAAb;YAAA,iBAiBC;YAfG,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAU,cAAc,CAAC,CAAC,KAAK,CAAC;YACjF,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,aAAa,CAAC,UAAU,EAAC,OAAO,CAAC,GAAG,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC;YACtG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,GAAG,CAAS,GAAG,CAAC,CAAC,IAAI,CACjE,UAAC,CAAC;gBACE,IAAI,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;gBAC5C,IAAI,CAAC,KAAK,GAAG,qBAAqB,CAAC,MAAM,CAAC,CAAC,EAAG,KAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;gBACtE,QAAQ,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;gBAC7E,OAAO,EAAE,CAAC;aACb,EAAE;YAEP,QACIC;gBACIA,+CAAG,EAAE,EAAC,qBAAqB,EAAC,IAAI,EAAC,EAAE,iBAAe,CAChD,EACR;SACL;QACL,uBAAC;IAAD,CA5BA,CAAsCC,uBAAW;;ICdjD;IACA;IACA;IAEA;IACA;AACAC,qCAAgB,CAAC,iBAAiB,CAAC;QAC/B,IAAI,EAAE,gCAAgC;QACtC,OAAO,EAAE,QAAQ;QACjB,QAAQ,EAAE;YACN,EAAE,eAAe,EAAE,kBAAkB,EAAE,WAAW,EAAE,gBAAgB,EAAE;SACzE;QACD,mBAAmB,EAAE,CAAE,aAAa,CAAE;KACzC,CAAC;;;;;;"}